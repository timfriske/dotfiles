#!/usr/bin/env bash

# K8S Get Secret Data
# ===================
# Tim Friske <me@tifr.de>
#
# Gets the base-64 encoded sensitive data of the given Kubernetes secret
# in decoded form, i.e. in plain-text.
#
# Deps:: bash, env, jq, kubectl

# Fail-fast.
shopt -os nounset pipefail errexit errtrace

kubectl get secret "${1:?secret name required}" --output json \
  | jq '.data | to_entries | map({(.key): (.value | @base64d)}) | add'
